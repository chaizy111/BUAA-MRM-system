import random
import pymysql

# 模拟的科室ID列表
unit_ids = [
    1021700, 1022300, 1020200, 1020600, 1020300, 1020100, 1010400, 1020800,
    1020900, 1021000, 1021100, 1025000, 1026000, 1027000, 1021200, 1020400,
    1022200, 1022400, 1020500, 1011300, 1010900, 1010300, 1010200, 1011000,
    1021600, 1010700, 1010500, 1011200, 1010100, 1020706, 1020707, 1021300,
    1020708, 1000000
]

# 中文姓名库
first_names = ["赵", "钱", "孙", "李", "周", "吴", "郑", "王", "冯", "陈", "褚", "卫", "蒋", "沈", "韩", "杨", "朱", "秦", "尤", "许", "何", "吕", "施", "张", "孔", "曹", "严", "华", "金", "魏", "陶", "姜", "戚", "谢", "邹", "喻", "柏", "水", "窦", "章", "云", "苏", "潘", "葛", "奚", "范", "彭", "鲁", "韦", "车", "卞", "邬", "方", "任", "袁", "柳", "鲍", "史", "唐", "费", "岑", "薛", "雷", "贺", "倪", "汤", "滕", "殷", "罗", "毕", "郝", "邬", "安", "常", "乐", "于", "时", "傅", "皮", "卞", "齐", "康", "伍", "余", "元", "卜", "顾", "孟", "平", "黄", "和", "穆", "萧", "尹", "姚", "邵", "湛", "汪", "祁", "毛", "禹", "狄", "米", "贝", "明", "臧", "计", "伏", "成", "戴", "谈", "宋", "茅", "庞", "熊", "纪", "舒", "屈", "项", "祝", "董", "梁", "杜", "阮", "蓝", "闵", "席", "季", "麻", "强", "贾", "路", "娄", "危", "江", "童", "颜", "郭", "梅"]
last_names = ["伟", "芳", "娜", "敏", "静", "丽", "强", "磊", "军", "洋", "旭", "梅", "琳", "欣", "洁", "俊", "杰", "明", "超", "越", "飞", "燕", "涛", "浩", "波", "光", "辉", "龙", "凤", "晨", "曦"]

# 职位库
positions = ["主任医师", "副主任医师", "主治医师", "住院医师", "护士", "护师", "技术员", "行政人员"]

#################################### 数据库操作 ##############################################
def make_connect():     # 建立数据库连接
    conn = pymysql.connect(
        host='localhost',		# 主机名（或IP地址）
        port=3306,				# 端口号，默认为3306
        user='root',			# 用户名
        password='2003',	# 你本地的数据库密码,请自行更改
        charset='utf8mb4'  		# 设置字符编码
    )
    conn.select_db("medical_record_management") # 选择数据库
    cursor = conn.cursor() # 创建游标对象
    # 获取mysql服务信息（测试连接，输出MySQL版本号）
    # print(conn.get_server_info())
    return (conn, cursor)


def break_connect(conn, cursor): # 断开数据库连接
    cursor.close()
    conn.close()
##############################################################################################

# 生成随机中文姓名
def generate_chinese_name():
    first = random.choice(first_names)
    last = random.choice(last_names)
    return f"{first}{last}"

if __name__ == '__main__':
    conn, cursor = make_connect()
    for _ in range(200):
        name = generate_chinese_name()
        position = random.choice(positions)
        unit_id = random.choice(unit_ids)
        sql = '''
            INSERT INTO staff (Name, Position, UnitID)
            VALUES (%s, %s, %s)
            '''
        cursor.execute(sql, (name, position, unit_id))

    # 提交事务
    conn.commit()
    break_connect(conn, cursor)



